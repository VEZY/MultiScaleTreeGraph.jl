<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Performance Considerations · MultiScaleTreeGraph.jl</title><meta name="title" content="Performance Considerations · MultiScaleTreeGraph.jl"/><meta property="og:title" content="Performance Considerations · MultiScaleTreeGraph.jl"/><meta property="twitter:title" content="Performance Considerations · MultiScaleTreeGraph.jl"/><meta name="description" content="Documentation for MultiScaleTreeGraph.jl."/><meta property="og:description" content="Documentation for MultiScaleTreeGraph.jl."/><meta property="twitter:description" content="Documentation for MultiScaleTreeGraph.jl."/><meta property="og:url" content="https://VEZY.github.io/MultiScaleTreeGraph.jl/tutorials/7.performance_considerations/"/><meta property="twitter:url" content="https://VEZY.github.io/MultiScaleTreeGraph.jl/tutorials/7.performance_considerations/"/><link rel="canonical" href="https://VEZY.github.io/MultiScaleTreeGraph.jl/tutorials/7.performance_considerations/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MultiScaleTreeGraph.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../get_started/">Getting started</a></li><li><span class="tocitem">The MTG format</span><ul><li><a class="tocitem" href="../../the_mtg/mtg_concept/">Concept</a></li><li><a class="tocitem" href="../../the_mtg/mtg_format/">File format</a></li><li><a class="tocitem" href="../../the_mtg/our_implementation/">Our implementation</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../0.read_write/">Read and Write MTGs</a></li><li><a class="tocitem" href="../1.manipulate_node/">Accessing node data</a></li><li><a class="tocitem" href="../2.descendants_ancestors_filters/">Node attributes</a></li><li><a class="tocitem" href="../3.transform_mtg/">Transform an MTG</a></li><li><a class="tocitem" href="../4.convert_mtg/">Converting MTGs</a></li><li><a class="tocitem" href="../5.plotting/">Plotting</a></li><li><a class="tocitem" href="../6.add_remove_nodes/">Add/remove nodes</a></li><li class="is-active"><a class="tocitem" href>Performance Considerations</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Performance-Tips"><span>Performance Tips</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Performance Considerations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Performance Considerations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/VEZY/MultiScaleTreeGraph.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/VEZY/MultiScaleTreeGraph.jl/blob/master/docs/src/tutorials/7.performance_considerations.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Performance-Considerations"><a class="docs-heading-anchor" href="#Performance-Considerations">Performance Considerations</a><a id="Performance-Considerations-1"></a><a class="docs-heading-anchor-permalink" href="#Performance-Considerations" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>This tutorial covers some of the performance considerations when using MultiScaleTreeGraph.jl. It is not meant to be a comprehensive guide, but rather a starting point for users to understand the performance implications of their code.</p><p>It is important to note that MultiScaleTreeGraph.jl is high-performance by design. The package is designed to be as fast as possible considering the most common use cases. However, there are some things that the user can do to improve performance.</p><h2 id="Performance-Tips"><a class="docs-heading-anchor" href="#Performance-Tips">Performance Tips</a><a id="Performance-Tips-1"></a><a class="docs-heading-anchor-permalink" href="#Performance-Tips" title="Permalink"></a></h2><h3 id="Vocabulary"><a class="docs-heading-anchor" href="#Vocabulary">Vocabulary</a><a id="Vocabulary-1"></a><a class="docs-heading-anchor-permalink" href="#Vocabulary" title="Permalink"></a></h3><p>This page uses a few technical words. Here is what they mean in MTG terms:</p><ul><li><strong>Traversal</strong>: visiting nodes one after another in the graph.</li><li><strong>Request</strong>: asking the MTG for data, for example <code>descendants(mtg, :Length)</code> or <code>ancestors(node, :Width)</code>.</li><li><strong>Direct traversal</strong>: reading the graph by following parent/children links directly.</li><li><strong>Indexed traversal</strong>: using a precomputed lookup table to answer some descendant requests faster.</li><li><strong>DFS (Depth-First Search)</strong>: one way to visit nodes; it goes deep into one branch before moving to the next branch.</li></ul><h3 id="Attribute-backend"><a class="docs-heading-anchor" href="#Attribute-backend">Attribute backend</a><a id="Attribute-backend-1"></a><a class="docs-heading-anchor-permalink" href="#Attribute-backend" title="Permalink"></a></h3><p>By default, <code>read_mtg</code> uses <code>ColumnarStore</code>, a typed per-symbol columnar backend. This is optimized for traversal + attribute extraction workloads and reduces repeated dictionary lookups in hot loops.</p><p>The explicit attribute API is:</p><ul><li><code>attribute(node, :key; default=nothing)</code></li><li><code>attribute!(node, :key, value)</code></li><li><code>attributes(node, format=:namedtuple | :dict)</code></li><li><code>add_column!</code>, <code>drop_column!</code>, <code>rename_column!</code> for schema updates</li></ul><p><code>read_mtg</code> always uses the typed columnar backend. If you build nodes manually, you can still pass <code>Dict</code>/<code>NamedTuple</code> values, and they are converted automatically to columnar attributes.</p><h3 id="MTG-encoding"><a class="docs-heading-anchor" href="#MTG-encoding">MTG encoding</a><a id="MTG-encoding-1"></a><a class="docs-heading-anchor-permalink" href="#MTG-encoding" title="Permalink"></a></h3><p>The MTG encoding is the type used to store the MTG information about the node, <em>i.e.</em> the <code>scale</code>, <code>index</code>, <code>symbol</code> and <code>link</code>.</p><p>By default, MultiScaleTreeGraph.jl uses a mutable encoding (<a href="../../api/#MultiScaleTreeGraph.MutableNodeMTG"><code>MutableNodeMTG</code></a>), which allows for modifying this information. However, if the user does not need to modify these, it is recommended to use an immutable encoding instead (<a href="../../api/#MultiScaleTreeGraph.NodeMTG"><code>NodeMTG</code></a>). This will improve performance significantly.</p><p>The internal representation of MTG <code>symbol</code> and <code>link</code> values is based on <code>Symbol</code> for faster comparisons and lower repeated allocations. For backward compatibility, string inputs are still accepted everywhere (constructors and filters), but using symbols in performance-critical code is recommended:</p><pre><code class="language-julia hljs">NodeMTG(:/, :Internode, 1, 2)
traverse(mtg, x -&gt; x, symbol=:Internode, link=:&lt;)</code></pre><h3 id="Traversal:-node-caching"><a class="docs-heading-anchor" href="#Traversal:-node-caching">Traversal: node caching</a><a id="Traversal:-node-caching-1"></a><a class="docs-heading-anchor-permalink" href="#Traversal:-node-caching" title="Permalink"></a></h3><p>MultiScaleTreeGraph.jl visits all nodes by default when traversing a tree. This is usually fast, but not always optimal. For example, in a very large tree with only two leaves of interest, we still visit every node even though we only need those two leaves.</p><p>To improve performance, it is possible to cache any type of <code>traversal</code>, including any kind of filter on the nodes, and then use the cached traversal instead of the default one. This will improve performance significantly.</p><div class="admonition is-info" id="Note-2ab8dead997c30cc"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-2ab8dead997c30cc" title="Permalink"></a></header><div class="admonition-body"><p>A cache is simply a saved result that can be reused later. Here, it saves references to the nodes selected by a traversal so the package does not need to re-scan the full tree each time. This usually improves speed at the cost of a small amount of extra memory.</p></div></div><p>To cache a traversal, you can use <a href="../../api/#MultiScaleTreeGraph.cache_nodes!-Tuple{Any}"><code>cache_nodes!</code></a>. For example, if you want to cache all the <strong>leaf</strong> nodes in the MTG, you can do:</p><pre><code class="language-julia hljs">cache_nodes!(mtg, symbol = :Leaf)</code></pre><p>This will cache all the nodes with the symbol <code>:Leaf</code> in the MTG. Then, the tree traversal functions will use the cached traversal to iterate over the nodes.</p><div class="admonition is-success" id="Tip-c9535f598f5d2efd"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-c9535f598f5d2efd" title="Permalink"></a></header><div class="admonition-body"><p>Tree traversal is <em>very</em> fast, so caching nodes is not always necessary. Caching should be used when the traversal is needed <strong>multiple times</strong>, and the traversal is sparse, <em>i.e.</em> a lot of nodes are filtered-out.</p></div></div><h3 id="Traversal:-descendants-values-caching"><a class="docs-heading-anchor" href="#Traversal:-descendants-values-caching">Traversal: descendants values caching</a><a id="Traversal:-descendants-values-caching-1"></a><a class="docs-heading-anchor-permalink" href="#Traversal:-descendants-values-caching" title="Permalink"></a></h3><p>Similarly to caching nodes during tree traversal, <a href="../../api/#MultiScaleTreeGraph.descendants!"><code>descendants!</code></a> (the <code>!</code> means &quot;update in place&quot;) provides a way to cache values from descendants of a node. This is useful when these values are needed many times, because it avoids traversing the tree repeatedly. For example, this is useful when computing total biomass supported by each segment.</p><h3 id="In-place-traversal-outputs"><a class="docs-heading-anchor" href="#In-place-traversal-outputs">In-place traversal outputs</a><a id="In-place-traversal-outputs-1"></a><a class="docs-heading-anchor-permalink" href="#In-place-traversal-outputs" title="Permalink"></a></h3><p>For repeated requests on large trees, prefer reusing buffers with in-place methods to reduce allocations:</p><pre><code class="language-julia hljs">vals = Float64[]
nodes = typeof(mtg)[]

descendants!(vals, mtg, :Length)
ancestors!(vals, get_node(mtg, 5), :Length)
descendants!(nodes, mtg, self=true)</code></pre><p>This pattern is especially useful when the same request is executed many times (e.g. across millions of leaves).</p><p><code>type=</code> for <code>descendants</code>/<code>ancestors</code> is deprecated because return eltypes are inferred automatically from typed columns.</p><h3 id="Hybrid-descendants-backend-(growth-safe)"><a class="docs-heading-anchor" href="#Hybrid-descendants-backend-(growth-safe)">Hybrid descendants backend (growth-safe)</a><a id="Hybrid-descendants-backend-(growth-safe)-1"></a><a class="docs-heading-anchor-permalink" href="#Hybrid-descendants-backend-(growth-safe)" title="Permalink"></a></h3><p>For <code>descendants(node, key, ...)</code> on columnar MTGs, the package supports:</p><ul><li><code>:auto</code> (default): use direct graph traversal when the MTG is changing a lot, and switch to indexed traversal when read requests dominate</li><li><code>:pointer</code>: always use direct graph traversal</li><li><code>:indexed</code>: always use the index (rebuilding it when structure changed)</li></ul><p>In other words:</p><ul><li>If your simulation is currently <strong>growing a lot</strong> (many inserted/deleted organs), <code>:pointer</code> behavior is usually best.</li><li>If your simulation is mostly <strong>reading values repeatedly</strong> from a mostly stable structure, <code>:indexed</code> behavior can be faster.</li><li><code>:auto</code> tries to choose between both automatically.</li></ul><pre><code class="language-julia hljs">descendants_strategy(mtg)          # :auto
descendants_strategy!(mtg, :pointer)
descendants_strategy!(mtg, :indexed)
descendants_strategy!(mtg, :auto)</code></pre><p>Typical mixed workflow:</p><pre><code class="language-julia hljs"># Growth phase (many structural mutations):
descendants_strategy!(mtg, :pointer)

# Analysis phase (many repeated descendant requests):
descendants_strategy!(mtg, :auto)   # or :indexed if structure is stable</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../6.add_remove_nodes/">« Add/remove nodes</a><a class="docs-footer-nextpage" href="../../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 19 February 2026 14:45">Thursday 19 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
