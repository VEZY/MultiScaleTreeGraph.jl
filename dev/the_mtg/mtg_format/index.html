<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>File format · MultiScaleTreeGraph.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://VEZY.github.io/MultiScaleTreeGraph.jl/the_mtg/mtg_format/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MultiScaleTreeGraph.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../get_started/">Getting started</a></li><li><span class="tocitem">The MTG format</span><ul><li><a class="tocitem" href="../mtg_concept/">Concept</a></li><li class="is-active"><a class="tocitem" href>File format</a><ul class="internal"><li><a class="tocitem" href="#Example-MTG"><span>Example MTG</span></a></li><li><a class="tocitem" href="#The-MTG-sections"><span>The MTG sections</span></a></li></ul></li><li><a class="tocitem" href="../our_implementation/">Our implementation</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/0.read_write/">Read and Write MTGs</a></li><li><a class="tocitem" href="../../tutorials/1.manipulate_node/">Accessing node data</a></li><li><a class="tocitem" href="../../tutorials/2.descendants_ancestors_filters/">Node attributes</a></li><li><a class="tocitem" href="../../tutorials/3.transform_mtg/">Transform an MTG</a></li><li><a class="tocitem" href="../../tutorials/4.convert_mtg/">Converting MTGs</a></li><li><a class="tocitem" href="../../tutorials/6.add_remove_nodes/">Add/remove nodes</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">The MTG format</a></li><li class="is-active"><a href>File format</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>File format</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/VEZY/MultiScaleTreeGraph.jl/blob/master/docs/src/the_mtg/mtg_format.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="The-.mtg-file-format"><a class="docs-heading-anchor" href="#The-.mtg-file-format">The <code>.mtg</code> file format</a><a id="The-.mtg-file-format-1"></a><a class="docs-heading-anchor-permalink" href="#The-.mtg-file-format" title="Permalink"></a></h1><p>The <code>.mtg</code> file format was developed in the <a href="https://amap.cirad.fr/">AMAP lab</a> to be able to describe a plant in the MTG format directly in a file.</p><p>The file format is generally used when measuring a plant on the field or to write on disk the results of an architectural model such as AMAPSim or VPalm for example. This format helps exchange and archive data about plants in a standard and efficient way.</p><p>The format is described in details in the original paper from Godin et al. (1998), but our implementation in Julia is detailed in this section.</p><h2 id="Example-MTG"><a class="docs-heading-anchor" href="#Example-MTG">Example MTG</a><a id="Example-MTG-1"></a><a class="docs-heading-anchor-permalink" href="#Example-MTG" title="Permalink"></a></h2><p>Let&#39;s define a very simple virtual plant composed of only two internodes and two leaves:</p><div class="sketchfab-embed-wrapper">
<iframe title="A 3D model" width="640" height="480" src="https://sketchfab.com/models/2a699871f6f6459faa11c206bf81ae9a/embed?autospin=0.2&amp;autostart=1&amp;preload=1&amp;ui_controls=1&amp;ui_infos=1&amp;ui_inspector=1&amp;ui_stop=1&amp;ui_watermark=1&amp;ui_watermark_link=1" frameborder="0" allow="autoplay; fullscreen; vr" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>
<p style="font-size: 13px; font-weight: normal; margin: 5px; color: #4A4A4A;">
<a href="https://sketchfab.com/3d-models/a-simple-3d-plant-2a699871f6f6459faa11c206bf81ae9a?utm_medium=embed&utm_source=website&utm_campaign=share-popup" target="_blank" style="font-weight: bold; color: #1CAAD9;">A simple 3D plant</a>
by <a href="https://sketchfab.com/rvezy?utm_medium=embed&utm_source=website&utm_campaign=share-popup" target="_blank" style="font-weight: bold; color: #1CAAD9;">rvezy</a>
on <a href="https://sketchfab.com?utm_medium=embed&utm_source=website&utm_campaign=share-popup" target="_blank" style="font-weight: bold; color: #1CAAD9;">Sketchfab</a>
</p>
</div><p>The corresponding MTG file is provided with this package. Let&#39;s print it using Julia&#39;s built-in read method:</p><pre><code class="language-julia hljs">using MultiScaleTreeGraph
file = joinpath(dirname(dirname(pathof(MultiScaleTreeGraph))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.mtg&quot;)
println(read(file, String))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CODE:	FORM-A

CLASSES:
SYMBOL	SCALE	DECOMPOSITION	INDEXATION	DEFINITION
$ 	0	FREE	FREE	IMPLICIT
Individual	1	FREE	FREE	IMPLICIT
Axis	2	FREE	FREE	IMPLICIT # you can add comments anywhere
Internode	3	FREE	FREE	IMPLICIT
Leaf	3	FREE	FREE	IMPLICIT

DESCRIPTION:
LEFT	RIGHT	RELTYPE	MAX
Internode	Internode,Leaf	+	?
Internode	Internode,Leaf	&lt;	?

FEATURES:
NAME	TYPE
Length	ALPHA
Width	ALPHA
XEuler	REAL

MTG:
ENTITY-CODE		Length	Width	XEuler
/Scene0
^/Individual0
^/Axis0
^/Internode0		0.1	0.02
	+Leaf0	0.2	0.1
^&lt;Internode1		0.1	0.02	180.0
	+Leaf0	0.2	0.1</code></pre><p>This is a consequent file for such a tiny plant! This is because MTG files have a header with several sections before the MTG of the plant itself, which only appears after the <code>MTG:</code> line.</p><p>Let&#39;s dig into the information we have here.</p><h2 id="The-MTG-sections"><a class="docs-heading-anchor" href="#The-MTG-sections">The MTG sections</a><a id="The-MTG-sections-1"></a><a class="docs-heading-anchor-permalink" href="#The-MTG-sections" title="Permalink"></a></h2><h3 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h3><p>An MTG file is divided into five sections. These sections are defined by a keyword and a colon. The content of each section appears on a new line right after the keyword. A section can appear right after the content of the previous section, or they can be separated by blank lines. In fact, all blank lines are ignored in an MTG file.</p><h3 id="The-CODE-section"><a class="docs-heading-anchor" href="#The-CODE-section">The CODE section</a><a id="The-CODE-section-1"></a><a class="docs-heading-anchor-permalink" href="#The-CODE-section" title="Permalink"></a></h3><p>The first section of an MTG file is the <code>CODE</code> section. It must appear first in the file as it is used to determine which version of the format specification the MTG file is following. The standard format in 2021 is the <code>FORM-A</code> specification. A new format is under reflexion but is not yet available.</p><h3 id="The-CLASSES-section"><a class="docs-heading-anchor" href="#The-CLASSES-section">The CLASSES section</a><a id="The-CLASSES-section-1"></a><a class="docs-heading-anchor-permalink" href="#The-CLASSES-section" title="Permalink"></a></h3><p>The <code>CLASSES</code> section lists all symbols used in the MTG, and associates the scale of each symbol.</p><p>The data is presented as a table with five columns:</p><ul><li><code>SYMBOL</code>: the string used for the node symbol.</li><li><code>SCALE</code>: the scale of the symbol, meaning all nodes with the given symbol will have this scale.</li><li><code>DECOMPOSITION</code>: This is not used anymore</li><li><code>INDEXATION</code>: This is not used anymore</li><li><code>DEFINITION</code>: This is not used anymore</li></ul><p>The first row of the table is reserved and shouldn&#39;t be updated. It is a standard to use the dollar sign as the symbol for the scene, <em>i.e.</em> the node with the higher scale that encompass all MTGs. This node is usually not used in an MTG because MTG files mostly describe just a single plant (or a part of), not a whole scene.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The symbol must be a character string without any numbers at the end, because the index of a node is read as the numbers at the end of a node name, so if a node symbol ends with a number, it will be parsed as an index. For example a symbol written <code>Axis1</code> with index <code>1</code> will give Axis11 in the MTG, which will be parsed as <code>Axis</code> for the symbol and <code>11</code> for the index. Numbers are allowed inside the symbol though, <em>e.g.</em> Ax1s is allowed.</p></div></div><h3 id="The-DESCRIPTION-section"><a class="docs-heading-anchor" href="#The-DESCRIPTION-section">The DESCRIPTION section</a><a id="The-DESCRIPTION-section-1"></a><a class="docs-heading-anchor-permalink" href="#The-DESCRIPTION-section" title="Permalink"></a></h3><p>The <code>DESCRIPTION</code> section is a table with four columns, and it defines a set of topological rules the MTG nodes of a same scale must follow. The rules are completely optional, but the header of the section is mandatory. In other words, the table can be empty.</p><p>The <code>LEFT</code> column designates the symbol of a parent node, the <code>RIGHT</code> column the symbol of a child node, the <code>RELTYPE</code> column the type of links allowed between the two, and <code>MAX</code> the maximum number of times these types of connexions are allowed in the MTG. The user can use a question mark to denote no maximum.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The rules only apply between symbols sharing the same scale (<em>e.g.</em> a node with itself, or in our example, the Internode with a Leaf).</p></div></div><p>These rules are mainly used to check the integrity of an MTG that has been written by hand on the field.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This package does not implement any check on the rules yet. You can let this section empty (with the header) for your MTG if you don&#39;t plan to read it with other tools than <code>MultiScaleTreeGraph.jl</code>.</p></div></div><h3 id="The-FEATURES-section"><a class="docs-heading-anchor" href="#The-FEATURES-section">The FEATURES section</a><a id="The-FEATURES-section-1"></a><a class="docs-heading-anchor-permalink" href="#The-FEATURES-section" title="Permalink"></a></h3><p>This section is a table with two columns that define the name of the attributes (or features) that can be attached to nodes, and the type of these attributes. This section makes sure that attributes are interpreted correctly when parsing the file.</p><p>The <code>NAME</code> column is used to give the name of an attribute, and the <code>TYPE</code> column its type. The type can be:</p><ul><li><code>REAL</code> for real numbers, <em>e.g.</em> 0.1</li><li><code>INT</code> for integer numbers, <em>e.g.</em> 1</li><li><code>STRING</code> for strings, <em>e.g.</em> broken</li><li><code>ALPHA</code> for reserved keywords:<ul><li>NbEl: NumBer of ELements, the number of children at the next scale</li><li>Length: the node length</li><li>BottomDiameter, the bottom tapering applied to the node for computing its geometry</li><li>TopDiameter, the tapering applied at the top</li><li>State, defines the state of a node. It can take the value D (Dead), A (Alive), B (Broken) , P (Pruned), G (Growing), V (Vegetative), R (Resting), C (Completed), M (Modified), or any combination of these given letters.</li></ul></li></ul><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This package does not implement any check on the State of a node, and does not make use of the reserved keywords.</p></div></div><h3 id="The-MTG-section"><a class="docs-heading-anchor" href="#The-MTG-section">The MTG section</a><a id="The-MTG-section-1"></a><a class="docs-heading-anchor-permalink" href="#The-MTG-section" title="Permalink"></a></h3><p>This section is the actual MTG. It describes the topology of the plant, and give the possibility to add attributes to them.</p><p>The MTG is encoded as a table with tabulation separated values. The header of this section defines the columns used for describing the topology and the ones used for the attributes. The first column name is reserved and must be named <code>ENTITY-CODE</code>. Then, a set of empty column names (<em>i.e.</em> just tabulations) that defines how many columns are used for the topology. Finally, the following columns are used to define the attributes of the nodes. Their names must match the ones given in <a href="#The-FEATURES-section">The FEATURES section</a>.</p><p>Each row of the table usually refers to a single node. The topology is and node description is given in the <code>ENTITY-CODE</code> columns.</p><p>In our example MTG, the first node is the scene: <code>/Scene0</code>. In this package, this notation is called a <a href="../../api/#MultiScaleTreeGraph.NodeMTG"><code>NodeMTG</code></a>. It is made out of three different information:</p><ul><li>The link to the parent node: <code>/</code></li><li>The node Symbol: <code>Scene</code></li><li>The node index: <code>0</code></li></ul><p>The link to the parent can be either <code>/</code> (decomposition), <code>&lt;</code> (following) or <code>+</code> (branching). you can read the <a href="../mtg_concept/#Node-MTG-and-attributes">Node MTG and attributes</a> section for more details on the signification of each. In few words, a node decomposes its parent if it changes the scale of description, follows if it is continuing after its parent, or branching if it branches from its parent.</p><p>The node symbol is used to determine the scale of the node and eventually its properties.</p><p>The node index is completely free. It is mainly used to keep track of the number of following segments on an axis, or the branching order.</p><p>The second node in our example is <code>^/Individual0</code>. It introduces a new character used as a prefix: <code>^</code>. By default the parent of a node is defined as the last node present in the column preceding it, <em>e.g.</em>:</p><table><tr><th style="text-align: right">node1</th><th style="text-align: right"></th></tr><tr><td style="text-align: right"></td><td style="text-align: right">node2</td></tr><tr><td style="text-align: right"></td><td style="text-align: right">node3</td></tr></table><p>Here node1 is the parent of node2 <strong>and</strong> node3. But if we want node2 as the parent of node3, we would have to create a new column:</p><table><tr><th style="text-align: right">node1</th><th style="text-align: right"></th><th style="text-align: right"></th></tr><tr><td style="text-align: right"></td><td style="text-align: right">node2</td><td style="text-align: right"></td></tr><tr><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">node3</td></tr></table><p>This means large MTGs would require a lot of columns for the topology encoding. This is where <code>^</code> becomes useful. It allows us to write a child in the same column as its parent, as long as the parent has only on child:</p><table><tr><th style="text-align: right">node1</th><th style="text-align: right"></th></tr><tr><td style="text-align: right"></td><td style="text-align: right">node2</td></tr><tr><td style="text-align: right"></td><td style="text-align: right">^node3</td></tr></table><p>In the example above, node1 is the parent of node2, and node2 is the parent of node3.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Because there is no explicit need to change column when nodes are decomposing or following, we usually create a new column only when a node branches to reduce the number of columns in the <code>ENTITY-CODE</code>.</p></div></div><p>Attributes are then declared in their respective columns defined in the header. If there is no value for an attribute, it is usually declared as an empty column</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>MTGs entered manually on the field are usually done in a spreadsheet software such as MS Excel or Only Office / Open Office / Libre Office Calc. Here is an <a href="https://github.com/VEZY/MultiScaleTreeGraph.jl/raw/master/test/files/tree3h.xlsx">example spreadsheet</a> used on the field.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mtg_concept/">« Concept</a><a class="docs-footer-nextpage" href="../our_implementation/">Our implementation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Wednesday 10 August 2022 11:00">Wednesday 10 August 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
