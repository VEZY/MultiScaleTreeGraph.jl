<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Our implementation · MultiScaleTreeGraph.jl</title><meta name="title" content="Our implementation · MultiScaleTreeGraph.jl"/><meta property="og:title" content="Our implementation · MultiScaleTreeGraph.jl"/><meta property="twitter:title" content="Our implementation · MultiScaleTreeGraph.jl"/><meta name="description" content="Documentation for MultiScaleTreeGraph.jl."/><meta property="og:description" content="Documentation for MultiScaleTreeGraph.jl."/><meta property="twitter:description" content="Documentation for MultiScaleTreeGraph.jl."/><meta property="og:url" content="https://VEZY.github.io/MultiScaleTreeGraph.jl/the_mtg/our_implementation/"/><meta property="twitter:url" content="https://VEZY.github.io/MultiScaleTreeGraph.jl/the_mtg/our_implementation/"/><link rel="canonical" href="https://VEZY.github.io/MultiScaleTreeGraph.jl/the_mtg/our_implementation/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MultiScaleTreeGraph.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../get_started/">Getting started</a></li><li><span class="tocitem">The MTG format</span><ul><li><a class="tocitem" href="../mtg_concept/">Concept</a></li><li><a class="tocitem" href="../mtg_format/">File format</a></li><li class="is-active"><a class="tocitem" href>Our implementation</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Data-types"><span>Data types</span></a></li><li><a class="tocitem" href="#Learning-by-example"><span>Learning by example</span></a></li></ul></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/0.read_write/">Read and Write MTGs</a></li><li><a class="tocitem" href="../../tutorials/1.manipulate_node/">Accessing node data</a></li><li><a class="tocitem" href="../../tutorials/2.descendants_ancestors_filters/">Node attributes</a></li><li><a class="tocitem" href="../../tutorials/3.transform_mtg/">Transform an MTG</a></li><li><a class="tocitem" href="../../tutorials/4.convert_mtg/">Converting MTGs</a></li><li><a class="tocitem" href="../../tutorials/5.plotting/">Plotting</a></li><li><a class="tocitem" href="../../tutorials/6.add_remove_nodes/">Add/remove nodes</a></li><li><a class="tocitem" href="../../tutorials/7.performance_considerations/">Performance Considerations</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">The MTG format</a></li><li class="is-active"><a href>Our implementation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Our implementation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/VEZY/MultiScaleTreeGraph.jl/blob/master/docs/src/the_mtg/our_implementation.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="MTG-implementation"><a class="docs-heading-anchor" href="#MTG-implementation">MTG implementation</a><a id="MTG-implementation-1"></a><a class="docs-heading-anchor-permalink" href="#MTG-implementation" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>In this package, the MTG is represented as a <a href="https://en.wikipedia.org/wiki/Tree_%28data_structure%29">tree data structure</a>.</p><p>The tree is built from a series of nodes with different fields that describe the topology (<em>i.e.</em> how nodes are connected together) and the attributes of the node.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The package use terms from computer science rather than plant biology. So we use words such as &quot;root&quot; in an MTG, which is not the plant root, but the first node in the tree, <em>i.e.</em> the one without any parent. Similarly a leaf node is not a leaf from a plant but a node without any children.</p></div></div><h2 id="Data-types"><a class="docs-heading-anchor" href="#Data-types">Data types</a><a id="Data-types-1"></a><a class="docs-heading-anchor-permalink" href="#Data-types" title="Permalink"></a></h2><p>The nodes have their own data type called <a href="../../api/#MultiScaleTreeGraph.Node"><code>Node</code></a>. A <a href="../../api/#MultiScaleTreeGraph.Node"><code>Node</code></a> has several fields:</p><pre><code class="language-julia hljs">fieldnames(Node)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(:id, :parent, :children, :MTG, :attributes, :traversal_cache)</code></pre><p>Here is a little description of each field:</p><ul><li><code>id</code>: The unique integer identifier of the node. It can be set by the user but is usually set automatically.</li><li><code>parent</code>: The parent node of the curent node. If the curent node is the root node, it will return <code>nothing</code>. You can test whether a node is a root node sing the <a href="../../api/#MultiScaleTreeGraph.isroot-Tuple{Node}"><code>isroot</code></a> function.</li><li>children: a dictionary of the children nodes with their <code>id</code> as key, or <code>nothing</code> if none;</li><li><code>MTG</code>: The MTG encoding of the node (see below, or <a href="../../api/#MultiScaleTreeGraph.NodeMTG"><code>NodeMTG</code></a>)</li><li><code>attributes</code>: the node attributes. Usually a <code>NamedTuple</code>, a <code>MutableNamedTuple</code> or a <code>Dict</code> or similar (e.g. <code>OrderedDict</code>), but the type is optional. The choice of the data structure depends mainly on how much you plan to change the attributes and their values. Attributes include for example the length or diameter of a node, its colour, 3d position...</li><li><code>traversal_cache</code>: a cache for the traversal, used by <em>e.g.</em> <a href="../../api/#MultiScaleTreeGraph.traverse"><code>traverse</code></a> to traverse more efficiently particular nodes in the MTG</li></ul><p>The value of tee fields are accessed using accessor functions: <a href="../../api/#MultiScaleTreeGraph.node_id-Tuple{Node}"><code>node_id</code></a>, <a href="../../api/#Base.parent-Union{Tuple{Node{T, A}}, Tuple{A}, Tuple{T}} where {T, A}"><code>parent</code></a>, <a href="../../api/#AbstractTrees.children-Union{Tuple{Node{T, A}}, Tuple{A}, Tuple{T}} where {T, A}"><code>children</code></a>, <a href="../../api/#MultiScaleTreeGraph.node_mtg-Tuple{Node}"><code>node_mtg</code></a>, <a href="../../api/#MultiScaleTreeGraph.node_attributes-Union{Tuple{Node{T, A}}, Tuple{A}, Tuple{T}} where {T, A}"><code>node_attributes</code></a>, and the last one <code>get_traversal_cache</code> which is not exported because users shouldn&#39;t use it directly.</p><p>The MTG field of a node describes the topology encoding of the node: its type of link with its parent (decompose: <code>/</code>, follow: <code>&lt;</code>, and branch: <code>+</code>), its symbol, index, and scale (see <a href="../mtg_concept/#Node-MTG-and-attributes">Node MTG and attributes</a> and <a href="../mtg_format/#The-MTG-section">The MTG section</a> for more details). The MTG field must be encoded in a data structure called <a href="../../api/#MultiScaleTreeGraph.NodeMTG"><code>NodeMTG</code></a> or in a <a href="../../api/#MultiScaleTreeGraph.MutableNodeMTG"><code>MutableNodeMTG</code></a>. They have four fields corresponding to the topology encoding:</p><pre><code class="language-julia hljs">fieldnames(NodeMTG)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(:link, :symbol, :index, :scale)</code></pre><p>Creating a <a href="../../api/#MultiScaleTreeGraph.NodeMTG"><code>NodeMTG</code></a> is very simple, just pass the arguments by position. For example if we have an Axis that decomposes its parent node (&quot;/&quot;), with an index 0 and a scale of 1, we would declare it as follows:</p><pre><code class="language-julia hljs">axis_mtg_encoding = NodeMTG(&quot;/&quot;, &quot;Axis&quot;, 0, 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">NodeMTG(&quot;/&quot;, &quot;Axis&quot;, 0, 1)</code></pre><p>The we can access the data using the dot syntax:</p><pre><code class="language-julia hljs">axis_mtg_encoding.symbol</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;Axis&quot;</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><a href="../../api/#MultiScaleTreeGraph.NodeMTG"><code>NodeMTG</code></a> is the immutable data type, meaning that information cannot be changed once read. By default the package the mutable equivalent called <a href="../../api/#MultiScaleTreeGraph.MutableNodeMTG"><code>MutableNodeMTG</code></a>. Accessing the information of a mutable data structure is slower, but it is more convenient if we need to change its values.</p></div></div><h2 id="Learning-by-example"><a class="docs-heading-anchor" href="#Learning-by-example">Learning by example</a><a id="Learning-by-example-1"></a><a class="docs-heading-anchor-permalink" href="#Learning-by-example" title="Permalink"></a></h2><p>Let&#39;s print again the example MTG from the previous section:</p><pre><code class="language-julia hljs">file = joinpath(dirname(dirname(pathof(MultiScaleTreeGraph))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.mtg&quot;)
println(read(file, String))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CODE:	FORM-A

CLASSES:
SYMBOL	SCALE	DECOMPOSITION	INDEXATION	DEFINITION
$ 	0	FREE	FREE	IMPLICIT
Individual	1	FREE	FREE	IMPLICIT
Axis	2	FREE	FREE	IMPLICIT # you can add comments anywhere
Internode	3	FREE	FREE	IMPLICIT
Leaf	3	FREE	FREE	IMPLICIT

DESCRIPTION:
LEFT	RIGHT	RELTYPE	MAX
Internode	Internode,Leaf	+	?
Internode	Internode,Leaf	&lt;	?

FEATURES:
NAME	TYPE
Length	ALPHA
Width	ALPHA
XEuler	REAL
isAlive	BOOLEAN
dateDeath	DD/MM/YY

MTG:
ENTITY-CODE		Length	Width	XEuler	isAlive	dateDeath
/Scene0
^/Individual0
^/Axis0
^/Internode0		0.1	0.02	1
	+Leaf0	0.2	0.1		0	24/08/2022
^&lt;Internode1		0.1	0.02	180.0	1
	+Leaf0	0.2	0.1		1</code></pre><p>We can use <a href="../../api/#MultiScaleTreeGraph.read_mtg"><code>read_mtg</code></a> from <code>MultiScaleTreeGraph.jl</code> to read this MTG:</p><pre><code class="language-julia hljs">file = joinpath(dirname(dirname(pathof(MultiScaleTreeGraph))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.mtg&quot;)
mtg = read_mtg(file)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">/ 1: Scene
└─ / 2: Individual
   └─ / 3: Axis
      └─ / 4: Internode
         ├─ + 5: Leaf
         └─ &lt; 6: Internode
            └─ + 7: Leaf
</code></pre><p><a href="../../api/#MultiScaleTreeGraph.read_mtg"><code>read_mtg</code></a> returns the first node of the MTG, of type <a href="../../api/#MultiScaleTreeGraph.Node"><code>Node</code></a>:</p><pre><code class="language-julia hljs">typeof(mtg)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Node{MutableNodeMTG, Dict{Symbol, Any}}</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The <a href="../../api/#MultiScaleTreeGraph.Node"><code>Node</code></a> is a parametric type, that&#39;s why <code>typeof(mtg)</code> also returns the type used for the MTG data in the node (<code>MutableNodeMTG</code>) and the type used for the attributes (<code>Dict{Symbol, Any}</code>). But this is not important here.</p></div></div><p>We can access the fields of the node using the accessor functions:</p><pre><code class="language-julia hljs">node_id(mtg)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1</code></pre><pre><code class="language-julia hljs">parent(mtg)</code></pre><p>This one returns <code>nothing</code> because the node is the root node, it has no parent, but we could use it on its child, and it would return the root again:</p><pre><code class="language-julia hljs">mtg_child = mtg[1]
parent(mtg_child) == mtg</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><pre><code class="language-julia hljs">children(mtg)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Node{MutableNodeMTG, Dict{Symbol, Any}}}:
 / 2: Individual
└─ / 3: Axis
   └─ / 4: Internode
      ├─ + 5: Leaf
      └─ &lt; 6: Internode
         └─ + 7: Leaf
</code></pre><pre><code class="language-julia hljs">node_mtg(mtg)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MutableNodeMTG(&quot;/&quot;, &quot;Scene&quot;, 0, 0)</code></pre><pre><code class="language-julia hljs">node_attributes(mtg)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Symbol, Any} with 3 entries:
  :scales      =&gt; [0, 1, 2, 3, 3]
  :description =&gt; <span class="sgr1">2×4 DataFrame</span>…
  :symbols     =&gt; SubString{String}[&quot;Scene&quot;, &quot;Individual&quot;, &quot;Axis&quot;, &quot;Internode&quot;,…</code></pre><p>The package also provide helper functions to access the MTG encoding of the node directly:</p><pre><code class="language-julia hljs">symbol(mtg)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;Scene&quot;</code></pre><pre><code class="language-julia hljs">index(mtg)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0</code></pre><pre><code class="language-julia hljs">scale(mtg)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mtg_format/">« File format</a><a class="docs-footer-nextpage" href="../../tutorials/0.read_write/">Read and Write MTGs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Monday 6 May 2024 12:23">Monday 6 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
