<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Our implementation · MultiScaleTreeGraph.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://VEZY.github.io/MultiScaleTreeGraph.jl/the_mtg/our_implementation/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MultiScaleTreeGraph.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../get_started/">Getting started</a></li><li><span class="tocitem">The MTG format</span><ul><li><a class="tocitem" href="../mtg_concept/">Concept</a></li><li><a class="tocitem" href="../mtg_format/">File format</a></li><li class="is-active"><a class="tocitem" href>Our implementation</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Data-types"><span>Data types</span></a></li><li><a class="tocitem" href="#Learning-by-example"><span>Learning by example</span></a></li></ul></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/0.read_write/">Read and Write MTGs</a></li><li><a class="tocitem" href="../../tutorials/1.manipulate_node/">Manipulate nodes</a></li><li><a class="tocitem" href="../../tutorials/2.descendants_ancestors_filters/">Computing</a></li><li><a class="tocitem" href="../../tutorials/3.transform_mtg/">Transform an MTG</a></li><li><a class="tocitem" href="../../tutorials/4.convert_mtg/">Converting MTGs</a></li><li><a class="tocitem" href="../../tutorials/5.plotting/">Plotting</a></li><li><a class="tocitem" href="../../tutorials/6.add_remove_nodes/">Add/remove nodes</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">The MTG format</a></li><li class="is-active"><a href>Our implementation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Our implementation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/VEZY/MultiScaleTreeGraph.jl/blob/master/docs/src/the_mtg/our_implementation.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="MTG-implementation"><a class="docs-heading-anchor" href="#MTG-implementation">MTG implementation</a><a id="MTG-implementation-1"></a><a class="docs-heading-anchor-permalink" href="#MTG-implementation" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>In this package, the MTG is represented as a <a href="https://en.wikipedia.org/wiki/Tree_%28data_structure%29">tree data structure</a>.</p><p>The tree is built from a series of nodes with different fields that describe the topology (<em>i.e.</em> how nodes are connected together) and the attributes of the node.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The package use terms from computer science rather than plant biology. So we use words such as &quot;root&quot; in an MTG, which is not the plant root, but the first node in the tree, <em>i.e.</em> the one without any parent. Similarly a leaf node is not a leaf from a plant but a node without any children.</p></div></div><h2 id="Data-types"><a class="docs-heading-anchor" href="#Data-types">Data types</a><a id="Data-types-1"></a><a class="docs-heading-anchor-permalink" href="#Data-types" title="Permalink"></a></h2><p>The nodes have their own data type called <a href="../../api/#MultiScaleTreeGraph.Node"><code>Node</code></a>. A <a href="../../api/#MultiScaleTreeGraph.Node"><code>Node</code></a> has several fields:</p><pre><code class="language-julia hljs">fieldnames(Node)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(:name, :id, :parent, :children, :siblings, :MTG, :attributes)</code></pre><p>Here is a little description of each field:</p><ul><li><code>name</code>: The name of the node. It is completely free, but is usually computing automatically when reading the MTG. The automatic name is based on the index of the node in the MTG, <em>e.g.</em> &quot;node_1&quot; for the first node.</li><li><code>parent</code>: The parent node of the curent node. If the curent node is the root node, it will return <code>nothing</code>. You can test whether a node is a root node sing the <a href="../../api/#MultiScaleTreeGraph.isroot-Tuple{Node}"><code>isroot</code></a> function.</li><li><code>children</code>: A dictionary with the children of the current node as values, and their name as keys.</li><li><code>siblings</code>: A dictionary with the siblings of the current node as values, and their name as keys.</li><li><code>MTG</code>: The MTG description of the node (see below)</li><li><code>attributes</code>: the node attributes, usually of the form of a dictionary, but the type is optional (can be a vector, a tuple...).</li></ul><p>The MTG field of a node describes the topology of the node (see <a href="../mtg_concept/#Node-MTG-and-attributes">Node MTG and attributes</a> and <a href="../mtg_format/#The-MTG-section">The MTG section</a> for more details). It is a data structure called <a href="../../api/#MultiScaleTreeGraph.NodeMTG"><code>NodeMTG</code></a>, which has four fields:</p><pre><code class="language-julia hljs">fieldnames(NodeMTG)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(:link, :symbol, :index, :scale)</code></pre><p>These fields correspond to the topology encoding of the node: the type of link with the parent node (decompose: <code>/</code>, follow: <code>&lt;</code>, and branch: <code>+</code>), the symbol of the node, its index, and its description scale.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><a href="../../api/#MultiScaleTreeGraph.NodeMTG"><code>NodeMTG</code></a> is the immutable data type, meaning that information cannot be changed once read. By default the package the mutable equivalent called <a href="../../api/#MultiScaleTreeGraph.MutableNodeMTG"><code>MutableNodeMTG</code></a>. Accessing the information of a mutable data structure is slower, but it is more convenient if we need to change its values.</p></div></div><h2 id="Learning-by-example"><a class="docs-heading-anchor" href="#Learning-by-example">Learning by example</a><a id="Learning-by-example-1"></a><a class="docs-heading-anchor-permalink" href="#Learning-by-example" title="Permalink"></a></h2><h3 id="Read-an-MTG"><a class="docs-heading-anchor" href="#Read-an-MTG">Read an MTG</a><a id="Read-an-MTG-1"></a><a class="docs-heading-anchor-permalink" href="#Read-an-MTG" title="Permalink"></a></h3><p>Let&#39;s print again the example MTG from the previous section:</p><pre><code class="language-julia hljs">file = joinpath(dirname(dirname(pathof(MultiScaleTreeGraph))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.mtg&quot;)
println(read(file, String))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CODE:	FORM-A

CLASSES:
SYMBOL	SCALE	DECOMPOSITION	INDEXATION	DEFINITION
$ 	0	FREE	FREE	IMPLICIT
Individual	1	FREE	FREE	IMPLICIT
Axis	2	FREE	FREE	IMPLICIT # you can add comments anywhere
Internode	3	FREE	FREE	IMPLICIT
Leaf	3	FREE	FREE	IMPLICIT

DESCRIPTION:
LEFT	RIGHT	RELTYPE	MAX
Internode	Internode,Leaf	+	?
Internode	Internode,Leaf	&lt;	?

FEATURES:
NAME	TYPE
XX	REAL
YY	REAL
ZZ	REAL
FileName	ALPHA
Length	ALPHA
Width	ALPHA
XEuler	REAL

MTG:
ENTITY-CODE		XX	YY	ZZ	FileName	Length	Width	XEuler
/Scene0
^/Individual0		0.0	0.0	0.0	simple_OPF.opf
^/Axis0
^/Internode0						4.0	1.0
	+Leaf0					10.0	6.0
^&lt;Internode1						6.0		170.0
	+Leaf0					12.0	7.0</code></pre><p>We can use <a href="../../api/#MultiScaleTreeGraph.read_mtg"><code>read_mtg</code></a> from <code>MultiScaleTreeGraph.jl</code> to read this MTG:</p><pre><code class="language-julia hljs">file = joinpath(dirname(dirname(pathof(MultiScaleTreeGraph))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.mtg&quot;)
mtg = read_mtg(file)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">/ 1: $
└─ / 2: Individual
   └─ / 3: Axis
      └─ / 4: Internode
         ├─ + 5: Leaf
         └─ &lt; 6: Internode
            └─ + 7: Leaf
</code></pre><p><a href="../../api/#MultiScaleTreeGraph.read_mtg"><code>read_mtg</code></a> returns the first node of the MTG, of type <a href="../../api/#MultiScaleTreeGraph.Node"><code>Node</code></a></p><pre><code class="language-julia hljs">typeof(mtg)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Node{MutableNodeMTG, Dict{Symbol, Any}}</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The <a href="../../api/#MultiScaleTreeGraph.Node"><code>Node</code></a> is a parametric type, that&#39;s why <code>typeof(mtg)</code> also returns the type used for the MTG data in the node (<code>MutableNodeMTG</code>) and the type used for the attributes (<code>Dict{Symbol, Any}</code>). But this is not important here.</p></div></div><h3 id="Accessing-a-node"><a class="docs-heading-anchor" href="#Accessing-a-node">Accessing a node</a><a id="Accessing-a-node-1"></a><a class="docs-heading-anchor-permalink" href="#Accessing-a-node" title="Permalink"></a></h3><p>The first node of the whole MTG is all we need to access every other nodes in the MTG, because they are all linked together. For example we can access the data of its child either using its name:</p><pre><code class="language- hljs">mtg.children[&quot;node_2&quot;]</code></pre><p>Or directly by indexing the node with an integer:</p><pre><code class="language-julia hljs">mtg[1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">/ 2: Individual
└─ / 3: Axis
   └─ / 4: Internode
      ├─ + 5: Leaf
      └─ &lt; 6: Internode
         └─ + 7: Leaf
</code></pre><p>We can iteratively index into the nodes to access the descendants of a node. For example if we need to access the 6th node (the 2nd Internode), we would do:</p><pre><code class="language-julia hljs">node_6 = mtg[1][1][1][2]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&lt; 6: Internode
└─ + 7: Leaf
</code></pre><p>Or more simply, we can use the <a href="../../api/#MultiScaleTreeGraph.get_node-Tuple{Node, String}"><code>get_node</code></a> function with the name of the node:</p><pre><code class="language-julia hljs">node_6 = get_node(mtg, &quot;node_6&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&lt; 6: Internode
└─ + 7: Leaf
</code></pre><p>To access the parent of a node, we would do:</p><pre><code class="language-julia hljs">node_6.parent</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">/ 4: Internode
├─ + 5: Leaf
└─ &lt; 6: Internode
   └─ + 7: Leaf
</code></pre><h3 id="Accessing-node-data"><a class="docs-heading-anchor" href="#Accessing-node-data">Accessing node data</a><a id="Accessing-node-data-1"></a><a class="docs-heading-anchor-permalink" href="#Accessing-node-data" title="Permalink"></a></h3><p>We can access the data of a node using the dot notation. For example to get its MTG data:</p><pre><code class="language-julia hljs">mtg.MTG</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MutableNodeMTG(&quot;/&quot;, &quot;\$&quot;, 0, 0)</code></pre><p>Or its attributes:</p><pre><code class="language-julia hljs">mtg.attributes</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Symbol, Any} with 3 entries:
  :scales      =&gt; [0, 1, 2, 3, 3]
  :description =&gt; 2×4 DataFrame…
  :symbols     =&gt; SubString{String}[&quot;\$&quot;, &quot;Individual&quot;, &quot;Axis&quot;, &quot;Internode&quot;, &quot;L…</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The attributes of the root node always include the data from the header sections of an MTG file: the scales of the MTG, the description and the symbols. You can learn more in <a href="../mtg_format/#The-MTG-sections">The MTG sections</a> if you want.</p></div></div><p>We can also access the attributes of a node by indexing the node with a Symbol:</p><pre><code class="language-julia hljs">node_6[:Length]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6.0</code></pre><p>... or a String:</p><pre><code class="language-julia hljs">node_6[&quot;Length&quot;]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6.0</code></pre><p>Which are both equivalent to:</p><pre><code class="language-julia hljs">node_6.attributes[:Length]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6.0</code></pre><p>You&#39;ll find more information on how to make computations over the MTG, how to transform it into a DataFrame, how to write it back to disk, or how to delete and insert new nodes in the tutorials.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mtg_format/">« File format</a><a class="docs-footer-nextpage" href="../../tutorials/0.read_write/">Read and Write MTGs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Thursday 2 December 2021 15:42">Thursday 2 December 2021</span>. Using Julia version 1.6.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
