<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Traversal, Descendants, Ancestors and Filters · MultiScaleTreeGraph.jl</title><meta name="title" content="Traversal, Descendants, Ancestors and Filters · MultiScaleTreeGraph.jl"/><meta property="og:title" content="Traversal, Descendants, Ancestors and Filters · MultiScaleTreeGraph.jl"/><meta property="twitter:title" content="Traversal, Descendants, Ancestors and Filters · MultiScaleTreeGraph.jl"/><meta name="description" content="Documentation for MultiScaleTreeGraph.jl."/><meta property="og:description" content="Documentation for MultiScaleTreeGraph.jl."/><meta property="twitter:description" content="Documentation for MultiScaleTreeGraph.jl."/><meta property="og:url" content="https://VEZY.github.io/MultiScaleTreeGraph.jl/tutorials/2.descendants_ancestors_filters/"/><meta property="twitter:url" content="https://VEZY.github.io/MultiScaleTreeGraph.jl/tutorials/2.descendants_ancestors_filters/"/><link rel="canonical" href="https://VEZY.github.io/MultiScaleTreeGraph.jl/tutorials/2.descendants_ancestors_filters/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MultiScaleTreeGraph.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../get_started/">Getting started</a></li><li><span class="tocitem">The MTG format</span><ul><li><a class="tocitem" href="../../the_mtg/mtg_concept/">Concept</a></li><li><a class="tocitem" href="../../the_mtg/mtg_format/">File format</a></li><li><a class="tocitem" href="../../the_mtg/our_implementation/">Our implementation</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../0.read_write/">Read and Write MTGs</a></li><li><a class="tocitem" href="../1.manipulate_node/">Create and Manipulate Nodes</a></li><li class="is-active"><a class="tocitem" href>Traversal, Descendants, Ancestors and Filters</a><ul class="internal"><li><a class="tocitem" href="#Get-attributes-of-a-node"><span>Get attributes of a node</span></a></li><li><a class="tocitem" href="#If-you-are-new-to-these-words"><span>If you are new to these words</span></a></li><li><a class="tocitem" href="#Traversal-quick-recipes"><span>Traversal quick recipes</span></a></li><li><a class="tocitem" href="#Descendants"><span>Descendants</span></a></li><li><a class="tocitem" href="#Ancestors"><span>Ancestors</span></a></li><li><a class="tocitem" href="#Filters"><span>Filters</span></a></li><li><a class="tocitem" href="#Transform-values"><span>Transform values</span></a></li><li><a class="tocitem" href="#Helpers"><span>Helpers</span></a></li></ul></li><li><a class="tocitem" href="../3.transform_mtg/">Transform and Select Attributes</a></li><li><a class="tocitem" href="../4.convert_mtg/">Convert MTGs to Tables and Graphs</a></li><li><a class="tocitem" href="../5.plotting/">Plot MTGs</a></li><li><a class="tocitem" href="../6.add_remove_nodes/">Add and Remove Nodes</a></li><li><a class="tocitem" href="../7.performance_considerations/">Performance Considerations</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Traversal, Descendants, Ancestors and Filters</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Traversal, Descendants, Ancestors and Filters</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/VEZY/MultiScaleTreeGraph.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/VEZY/MultiScaleTreeGraph.jl/blob/master/docs/src/tutorials/2.descendants_ancestors_filters.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Traversal,-descendants,-ancestors-and-filters"><a class="docs-heading-anchor" href="#Traversal,-descendants,-ancestors-and-filters">Traversal, descendants, ancestors and filters</a><a id="Traversal,-descendants,-ancestors-and-filters-1"></a><a class="docs-heading-anchor-permalink" href="#Traversal,-descendants,-ancestors-and-filters" title="Permalink"></a></h1><h2 id="Get-attributes-of-a-node"><a class="docs-heading-anchor" href="#Get-attributes-of-a-node">Get attributes of a node</a><a id="Get-attributes-of-a-node-1"></a><a class="docs-heading-anchor-permalink" href="#Get-attributes-of-a-node" title="Permalink"></a></h2><p>Let&#39;s first read our example MTG:</p><pre><code class="language-julia hljs">using MultiScaleTreeGraph

file = joinpath(dirname(dirname(pathof(MultiScaleTreeGraph))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.mtg&quot;)
mtg = read_mtg(file)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Symbols: Scene  Individual  Axis  Internode  Leaf
Scales:  0      1           2     3          3   
/ 1: Scene
└─ / 2: Individual
   └─ / 3: Axis
      └─ / 4: Internode
         ├─ + 5: Leaf
         └─ &lt; 6: Internode
            └─ + 7: Leaf
</code></pre><h2 id="If-you-are-new-to-these-words"><a class="docs-heading-anchor" href="#If-you-are-new-to-these-words">If you are new to these words</a><a id="If-you-are-new-to-these-words-1"></a><a class="docs-heading-anchor-permalink" href="#If-you-are-new-to-these-words" title="Permalink"></a></h2><p>If you are not from computer science, the vocabulary can be confusing. In this package:</p><ul><li><strong>Traversal</strong> means &quot;walking through nodes one by one&quot;.</li><li>A <strong>parent</strong> is the node directly above another node.</li><li>A <strong>child</strong> is a node directly below another node.</li><li><strong>Descendants</strong> are children, children of children, etc.</li><li><strong>Ancestors</strong> are parent, parent of parent, etc.</li></ul><p>You can think of this like a family tree.</p><p>For the common cases:</p><ul><li>Use <a href="../../api/#MultiScaleTreeGraph.descendants"><code>descendants</code></a> to move downward in the MTG.</li><li>Use <a href="../../api/#MultiScaleTreeGraph.ancestors-Tuple{Any, Any}"><code>ancestors</code></a> to move upward in the MTG.</li><li>Add filters (<code>symbol</code>, <code>scale</code>, <code>filter_fun</code>) when you only need part of the MTG.</li></ul><h2 id="Traversal-quick-recipes"><a class="docs-heading-anchor" href="#Traversal-quick-recipes">Traversal quick recipes</a><a id="Traversal-quick-recipes-1"></a><a class="docs-heading-anchor-permalink" href="#Traversal-quick-recipes" title="Permalink"></a></h2><p>These examples cover the most common requests:</p><pre><code class="language-julia hljs">node_5 = get_node(mtg, 5)

# 1) Get one attribute for the whole subtree
descendants(mtg, :Length)

# 2) Get nodes instead of values
descendants(mtg)

# 3) Get one attribute from parents and grandparents
ancestors(node_5, :Length)

# 4) Filter by symbol and ignore nodes without the attribute
descendants(mtg, :Length, symbol=:Leaf, ignore_nothing=true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 0.2
 0.2</code></pre><div class="admonition is-success" id="Tip-724c199b2f9a705e"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-724c199b2f9a705e" title="Permalink"></a></header><div class="admonition-body"><p>If you call the same traversal many times in a simulation loop, look at <a href="../7.performance_considerations/#Performance-Considerations">Performance Considerations</a>, especially in-place methods (<code>descendants!</code>, <code>ancestors!</code>).</p></div></div><p>You can get all the attributes of a node as a dictionary snapshot using <a href="../../api/#MultiScaleTreeGraph.attributes-Tuple{Node}"><code>attributes</code></a>:</p><pre><code class="language-julia hljs">attributes(mtg, format=:dict)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Symbol, Any} with 3 entries:
  :scales      =&gt; [0, 1, 2, 3, 3]
  :description =&gt; ColumnTable([:LEFT, :RIGHT, :RELTYPE, :MAX], Dict(:LEFT=&gt;1, :…
  :symbols     =&gt; [&quot;Scene&quot;, &quot;Individual&quot;, &quot;Axis&quot;, &quot;Internode&quot;, &quot;Leaf&quot;]</code></pre><div class="admonition is-info" id="Note-5eb97ab915723ab0"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-5eb97ab915723ab0" title="Permalink"></a></header><div class="admonition-body"><p>The attributes of the root node always include the data from the header sections of an MTG file: the scales of the MTG, the description and the symbols. You can learn more in <a href="../../the_mtg/mtg_format/#The-MTG-sections">The MTG sections</a>.</p></div></div><p>We can also access particular attribute values by indexing into the node with a Symbol:</p><pre><code class="language-julia hljs">node_5 = get_node(mtg, 5) # Get the 5th node of the MTG

node_5[:Length]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.2</code></pre><p>... or a String:</p><pre><code class="language-julia hljs">node_5[&quot;Length&quot;]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.2</code></pre><p>And even with the dot notation:</p><pre><code class="language-julia hljs">node_5.Length</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.2</code></pre><p>This one even has autocompletion! It means that you can type <code>node_5.</code> and then press <code>TAB</code> to see all the available attributes, and when you start typing the name of an attribute, it will suggest the completion of the name.</p><p>The previous notations are equivalent to:</p><pre><code class="language-julia hljs">attribute(node_5, :Length)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.2</code></pre><p>Use <a href="../../api/#MultiScaleTreeGraph.attributes-Tuple{Node}"><code>attributes</code></a> when you want all values from one node at once.</p><p>For day-to-day use, the simpler APIs are usually clearer:</p><ul><li><code>node[:attr]</code></li><li><code>attribute(node, :attr)</code></li><li><code>attribute!(node, :attr, value)</code></li></ul><p>To get the names of all attributes available in the node subtree, you can use <a href="../../api/#MultiScaleTreeGraph.get_attributes-Tuple{Any}"><code>get_attributes</code></a>:</p><pre><code class="language-julia hljs">get_attributes(node_5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Symbol}:
 :Length
 :Width
 :dateDeath
 :isAlive</code></pre><p>We also define an alias for a more <code>DataFrame.jl</code>-alike experience (<a href="../../api/#Base.names-Tuple{T} where T&lt;:Node"><code>names</code></a>):</p><pre><code class="language-julia hljs">names(node_5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Symbol}:
 :Length
 :Width
 :dateDeath
 :isAlive</code></pre><p>Note that it returns only two attributes here because &quot;node_5&quot; is a leaf (a node without children), and <a href="../../api/#MultiScaleTreeGraph.get_attributes-Tuple{Any}"><code>get_attributes</code></a> and <a href="../../api/#Base.names-Tuple{T} where T&lt;:Node"><code>names</code></a> only return the attributes present in the node&#39;s subtree. To be sure to get all the attributes available in the whole MTG, it is better to call <a href="../../api/#MultiScaleTreeGraph.get_attributes-Tuple{Any}"><code>get_attributes</code></a> on the root node like so:</p><pre><code class="language-julia hljs">get_attributes(mtg)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">8-element Vector{Symbol}:
 :description
 :symbols
 :scales
 :XEuler
 :Length
 :Width
 :isAlive
 :dateDeath</code></pre><p>If you start from another node you can retrieve the root node using <a href="../../api/#MultiScaleTreeGraph.get_root-Tuple{Node}"><code>get_root</code></a>:</p><pre><code class="language-julia hljs">get_attributes(get_root(node_5))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">8-element Vector{Symbol}:
 :description
 :symbols
 :scales
 :XEuler
 :Length
 :Width
 :isAlive
 :dateDeath</code></pre><p>A simple way to get all nodes and their attributes is to use the unified table view:</p><pre><code class="language-julia hljs">to_table(mtg)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Symbols: Scene  Individual  Axis  Internode  Leaf
Scales:  0      1           2     3          3   
<span class="sgr1">                           Attributes Table (7 x 11)</span>
╭───┬─────────┬────────────┬───────┬───────┬────────┬───────────┬──────────┬────
│<span class="sgr1">   </span>│<span class="sgr1"> node_id </span>│<span class="sgr1">     symbol </span>│<span class="sgr1"> scale </span>│<span class="sgr1"> index </span>│<span class="sgr1">   link </span>│<span class="sgr1"> parent_id </span>│<span class="sgr1">   XEuler </span>│<span class="sgr1">  </span> ⋯
│<span class="sgr1">   </span>│<span class="sgr90">   Int64 </span>│<span class="sgr90">     Symbol </span>│<span class="sgr90"> Int64 </span>│<span class="sgr90"> Int64 </span>│<span class="sgr90"> Symbol </span>│<span class="sgr90">    Int64? </span>│<span class="sgr90"> Float64? </span>│<span class="sgr90"> F</span> ⋯
├───┼─────────┼────────────┼───────┼───────┼────────┼───────────┼──────────┼────
│<span class="sgr1"> 1 </span>│       1 │      Scene │     0 │     0 │      / │   missing │  missing │   ⋯
│<span class="sgr1"> 2 </span>│       2 │ Individual │     1 │     0 │      / │         1 │  missing │   ⋯
│<span class="sgr1"> 3 </span>│       3 │       Axis │     2 │     0 │      / │         2 │  missing │   ⋯
│<span class="sgr1"> 4 </span>│       4 │  Internode │     3 │     0 │      / │         3 │      1.0 │   ⋯
│<span class="sgr1"> 5 </span>│       5 │       Leaf │     3 │     0 │      + │         4 │  missing │   ⋯
│<span class="sgr1"> 6 </span>│       6 │  Internode │     3 │     1 │      &lt; │         4 │    180.0 │   ⋯
│<span class="sgr1"> 7 </span>│       7 │       Leaf │     3 │     0 │      + │         6 │  missing │   ⋯
╰───┴─────────┴────────────┴───────┴───────┴────────┴───────────┴──────────┴────
<span class="sgr36">                                                               4 columns omitted</span>
</code></pre><h2 id="Descendants"><a class="docs-heading-anchor" href="#Descendants">Descendants</a><a id="Descendants-1"></a><a class="docs-heading-anchor-permalink" href="#Descendants" title="Permalink"></a></h2><p>An MTG can hold a lot of information, usually measured locally at one given scale. It is often interesting to compute new attributes based on the topological environment of the nodes.</p><p>For example one could be interested in computing the total length of all nodes in a plant. To do so we must get the attributes of all descendants of a node. This is quite easy to do using <code>MultiScaleTreeGraph.jl</code>. For example to get the length attributes we would do:</p><pre><code class="language-julia hljs">descendants(mtg, :Length)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{Union{Nothing, Float64}}:
  nothing
  nothing
 0.1
 0.2
 0.1
 0.2</code></pre><p>The <code>descendants</code> function visits each child, then each child of each child, and so on until leaves. It returns values in the same order as nodes are visited.</p><p>The function can also help get the nodes directly if we don&#39;t pass any attribute:</p><pre><code class="language-julia hljs">descendants(mtg)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{Node{MutableNodeMTG, MultiScaleTreeGraph.ColumnarAttrs}}:
 / 2: Individual
└─ / 3: Axis
   └─ / 4: Internode
      ├─ + 5: Leaf
      └─ &lt; 6: Internode
         └─ + 7: Leaf

 / 3: Axis
└─ / 4: Internode
   ├─ + 5: Leaf
   └─ &lt; 6: Internode
      └─ + 7: Leaf

 / 4: Internode
├─ + 5: Leaf
└─ &lt; 6: Internode
   └─ + 7: Leaf

 + 5: Leaf

 &lt; 6: Internode
└─ + 7: Leaf

 + 7: Leaf
</code></pre><p>This is useful to get more information about the nodes, like their scale, symbol, index, or link to their parent. You can still get attributes for each returned node, for example:</p><pre><code class="language-julia hljs">[attributes(node, format=:dict) for node in descendants(mtg)]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{Dict{Symbol, Any}}:
 Dict()
 Dict()
 Dict(:XEuler =&gt; 1.0, :Length =&gt; 0.1, :Width =&gt; 0.02, :isAlive =&gt; nothing)
 Dict(:Length =&gt; 0.2, :Width =&gt; 0.1, :dateDeath =&gt; Dates.Date(&quot;2022-08-24&quot;), :isAlive =&gt; false)
 Dict(:XEuler =&gt; 180.0, :Length =&gt; 0.1, :Width =&gt; 0.02, :isAlive =&gt; true)
 Dict(:Length =&gt; 0.2, :Width =&gt; 0.1, :dateDeath =&gt; nothing, :isAlive =&gt; true)</code></pre><h2 id="Ancestors"><a class="docs-heading-anchor" href="#Ancestors">Ancestors</a><a id="Ancestors-1"></a><a class="docs-heading-anchor-permalink" href="#Ancestors" title="Permalink"></a></h2><p>To get the values of an attribute from the ancestors of a node, we would similarly do:</p><pre><code class="language-julia hljs">node_5 = get_node(mtg, 5)
ancestors(node_5, :Length)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Union{Nothing, Float64}}:
 0.1
  nothing
  nothing
  nothing</code></pre><h2 id="Filters"><a class="docs-heading-anchor" href="#Filters">Filters</a><a id="Filters-1"></a><a class="docs-heading-anchor-permalink" href="#Filters" title="Permalink"></a></h2><p>Sometimes we only want the values of descendants or ancestors based on a given information. It is possible to filter out nodes based on their scale, symbol, link, or really anything by using the keyword arguments.</p><h3 id="Filter-by-scale"><a class="docs-heading-anchor" href="#Filter-by-scale">Filter by scale</a><a id="Filter-by-scale-1"></a><a class="docs-heading-anchor-permalink" href="#Filter-by-scale" title="Permalink"></a></h3><p>For example if we want the length of all descendants of the root node of our MTG that are of scale 3 (leaves &amp; internodes), we would simply do:</p><pre><code class="language-julia hljs">descendants(mtg, :Length, scale = 3)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Union{Nothing, Float64}}:
 0.1
 0.2
 0.1
 0.2</code></pre><h3 id="Filter-by-symbol"><a class="docs-heading-anchor" href="#Filter-by-symbol">Filter by symbol</a><a id="Filter-by-symbol-1"></a><a class="docs-heading-anchor-permalink" href="#Filter-by-symbol" title="Permalink"></a></h3><p>If we need only the leaves, we would filter by their symbol (<em>i.e.</em> :Leaf):</p><pre><code class="language-julia hljs">descendants(mtg, :Length, symbol = :Leaf)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Union{Nothing, Float64}}:
 0.2
 0.2</code></pre><h3 id="Filter-by-anything"><a class="docs-heading-anchor" href="#Filter-by-anything">Filter by anything</a><a id="Filter-by-anything-1"></a><a class="docs-heading-anchor-permalink" href="#Filter-by-anything" title="Permalink"></a></h3><p>And if we want to filter depending on an arbitrary value, we can use the <code>filter_fun</code> argument. For example if we want the length of the nodes, but only the ones with a width greater than 1, will would do like so:</p><pre><code class="language-julia hljs">descendants(mtg, :Length, filter_fun = x -&gt; x[:Width] === nothing ? false : x[:Width] &gt; 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Union{Nothing, Float64}[]</code></pre><div class="admonition is-warning" id="Warning-ad72db9896f14c0b"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-ad72db9896f14c0b" title="Permalink"></a></header><div class="admonition-body"><p>By default if a node does not have an attribute, trying to get its value returns <code>nothing</code>. So if one uses attributes in the function passed to <code>filter_fun</code>, the function must handle missing values. This is what we do here by first testing if <code>x[:Width]</code> is <code>nothing</code> (in which case we return <code>false</code> to filter out the node), and then apply our test on the value of the node width.</p></div></div><div class="admonition is-info" id="Note-b6827355238c14f5"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-b6827355238c14f5" title="Permalink"></a></header><div class="admonition-body"><p>The function passed to <code>filter_fun</code> must take a node as input, not attributes directly. This is because we want to be able to access any information the user could need.</p></div></div><p>Because <code>filter_fun</code> takes a node as input, we can even filter on the node&#39;s parent. Let&#39;s say for example we want the values for the :Length, but only for the nodes that are children of a an Internode that follows another node:</p><pre><code class="language-julia hljs">descendants(mtg, :Length, filter_fun = node -&gt; !isroot(node) &amp;&amp; symbol(parent(node)) == :Internode &amp;&amp; link(parent(node)) == :&lt;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Union{Nothing, Float64}}:
 0.2</code></pre><p>In this example it returns only one value, because there is only one node that corresponds to this criteria: The Leaf with id 7.</p><p>We could apply the same kind of filtering on the node&#39;s children, or any combination of topological information and attributes.</p><p>Note that we first test if the node is not the root node, because the root node does not have a parent. We then test if the parent&#39;s symbol is :Internode and if the link is :&lt;.</p><h3 id="Filter-helpers"><a class="docs-heading-anchor" href="#Filter-helpers">Filter helpers</a><a id="Filter-helpers-1"></a><a class="docs-heading-anchor-permalink" href="#Filter-helpers" title="Permalink"></a></h3><p>There are three other arguments to help filtering nodes.</p><p>The first one is <code>all</code>. It is used to stop the search for new nodes as soon as one node does not correspond to the filters the user asked for.</p><p>It is generally used to get all nodes that have a &quot;follow&quot; link (&quot;&lt;&quot;) with their parents for example. You can find an example usage <a href="https://github.com/VEZY/Biomass_evaluation_LiDAR/blob/98576d0d2e9b9cfc9588451cc2bce42df68a6c87/1-code/functions.jl#L54">here</a>, where we compute the index of the segment nodes (&quot;S&quot;) along an axis (&quot;A&quot;), except for branching nodes, <em>i.e.</em> only the nodes that either decompose (&quot;/&quot;) or follow (&quot;&lt;&quot;).</p><p>The second one is the <code>self</code> argument. It is used to return the value of the node on which we call the function if its <code>true</code>, and only the ancestors / descendants if <code>false</code> (the default).</p><p>The third one is the <code>recursivity_level</code>, that is used to control the depth of the search for the  ancestors / descendants. It is set to <code>-1</code> by default, which does not apply any filter on the depth. It is generally used to get <em>e.g.</em> only the children values of a node (<code>recursivity_level = 1</code>).</p><p>The fourth one is <code>ignore_nothing</code>. It is used to not return the values of a node if it is <code>nothing</code>. Note that it is applied <strong>after</strong> the filter, so <code>filter_fun</code> still has to handle <code>nothing</code> values.</p><h2 id="Transform-values"><a class="docs-heading-anchor" href="#Transform-values">Transform values</a><a id="Transform-values-1"></a><a class="docs-heading-anchor-permalink" href="#Transform-values" title="Permalink"></a></h2><h3 id="Assign-attributes-to-a-node"><a class="docs-heading-anchor" href="#Assign-attributes-to-a-node">Assign attributes to a node</a><a id="Assign-attributes-to-a-node-1"></a><a class="docs-heading-anchor-permalink" href="#Assign-attributes-to-a-node" title="Permalink"></a></h3><p>It is possible to change the values of attributes in a node. For example one could be interested to compute the total length of all nodes for the scene in our example MTG. In this case we can do:</p><pre><code class="language-julia hljs">mtg[:Length] = sum(descendants(mtg, :Length, ignore_nothing = true))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.6000000000000001</code></pre><h3 id="Compute-attributes-in-an-MTG"><a class="docs-heading-anchor" href="#Compute-attributes-in-an-MTG">Compute attributes in an MTG</a><a id="Compute-attributes-in-an-MTG-1"></a><a class="docs-heading-anchor-permalink" href="#Compute-attributes-in-an-MTG" title="Permalink"></a></h3><p>Now MTGs can be very large, and it quickly becomes cumbersome to manually visit each node to change its value.</p><p>Instead, you can compute new attributes for all nodes in an MTG using <a href="../../api/#MultiScaleTreeGraph.transform"><code>transform</code></a>. Head to the next tutorial for more information: <a href="../3.transform_mtg/#Transform-an-MTG">Transform an MTG</a>.</p><h2 id="Helpers"><a class="docs-heading-anchor" href="#Helpers">Helpers</a><a id="Helpers-1"></a><a class="docs-heading-anchor-permalink" href="#Helpers" title="Permalink"></a></h2><p>Some helper functions can be useful when filtering nodes. For example you can use <a href="../../api/#MultiScaleTreeGraph.isroot-Tuple{Node}"><code>isroot</code></a> to test if a node is the root node of the MTG. This is particularly useful when searching for ancestor values, but need a special treatment for the root node.</p><p>Similarly, you can use <a href="../../api/#MultiScaleTreeGraph.isleaf-Tuple{Node}"><code>isleaf</code></a> to filter the leaf nodes of an MTG.</p><p>You also have <a href="../../api/#MultiScaleTreeGraph.nleaves"><code>nleaves</code></a> to compute the number of leaf nodes on the sub-tree of a given node.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.manipulate_node/">« Create and Manipulate Nodes</a><a class="docs-footer-nextpage" href="../3.transform_mtg/">Transform and Select Attributes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 19 February 2026 19:13">Thursday 19 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
